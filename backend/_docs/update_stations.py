from pymongo import MongoClient
import json
def update_storage_collection(data):
    # Conectar a MongoDB
    client = MongoClient('mongodb://root:Quartup!01@localhost:27017')
    db = client['solplay_almacen']  # Reemplaza con el nombre de tu base de datos
    storages = db.storages

    for item in data:
        # Criterios de búsqueda
        query = {
            'station_id': item['station_id'],
            'station_type': item['station_type'],
            'level': item['level']
        }
        print(query)
        # Actualización
        update = {
            '$set': {'preferent_order': item['prefered_order']},
            '$unset': {'prefered_order': ''}
        }

         # Imprimir query y update como JSON
        print("Query:")
        print(json.dumps(query, indent=2))
        print("Update:")
        print(json.dumps(update, indent=2))

        # Actualizar el documento
        result = storages.update_one(query, update)

        if result.modified_count > 0:
            print(f"Actualizado: {query}")
        else:
            print(f"No se encontró documento para actualizar: {query}")

    client.close()

# Ejemplo de uso
data_to_update = [{'station_id': 63, 'station_type': 3, 'level': 2, 'prefered_order': 2}, {'station_id': 63, 'station_type': 3, 'level': 1, 'prefered_order': 190}, {'station_id': 63, 'station_type': 1, 'level': 1, 'prefered_order': 127}, {'station_id': 63, 'station_type': 1, 'level': 2, 'prefered_order': 1}, {'station_id': 62, 'station_type': 3, 'level': 2, 'prefered_order': 4}, {'station_id': 62, 'station_type': 3, 'level': 1, 'prefered_order': 128}, {'station_id': 62, 'station_type': 1, 'level': 1, 'prefered_order': 191}, {'station_id': 62, 'station_type': 1, 'level': 2, 'prefered_order': 3}, {'station_id': 61, 'station_type': 3, 'level': 2, 'prefered_order': 6}, {'station_id': 61, 'station_type': 3, 'level': 1, 'prefered_order': 192}, {'station_id': 61, 'station_type': 1, 'level': 1, 'prefered_order': 129}, {'station_id': 61, 'station_type': 1, 'level': 2, 'prefered_order': 5}, {'station_id': 60, 'station_type': 3, 'level': 2, 'prefered_order': 8}, {'station_id': 60, 'station_type': 3, 'level': 1, 'prefered_order': 130}, {'station_id': 60, 'station_type': 1, 'level': 1, 'prefered_order': 193}, {'station_id': 60, 'station_type': 1, 'level': 2, 'prefered_order': 7}, {'station_id': 59, 'station_type': 3, 'level': 2, 'prefered_order': 10}, {'station_id': 59, 'station_type': 3, 'level': 1, 'prefered_order': 194}, {'station_id': 59, 'station_type': 1, 'level': 1, 'prefered_order': 131}, {'station_id': 59, 'station_type': 1, 'level': 2, 'prefered_order': 9}, {'station_id': 58, 'station_type': 3, 'level': 2, 'prefered_order': 12}, {'station_id': 58, 'station_type': 3, 'level': 1, 'prefered_order': 132}, {'station_id': 58, 'station_type': 1, 'level': 1, 'prefered_order': 195}, {'station_id': 58, 'station_type': 1, 'level': 2, 'prefered_order': 11}, {'station_id': 57, 'station_type': 3, 'level': 2, 'prefered_order': 14}, {'station_id': 57, 'station_type': 3, 'level': 1, 'prefered_order': 196}, {'station_id': 57, 'station_type': 1, 'level': 1, 'prefered_order': 133}, {'station_id': 57, 'station_type': 1, 'level': 2, 'prefered_order': 13}, {'station_id': 56, 'station_type': 3, 'level': 2, 'prefered_order': 16}, {'station_id': 56, 'station_type': 3, 'level': 1, 'prefered_order': 134}, {'station_id': 56, 'station_type': 1, 'level': 1, 'prefered_order': 197}, {'station_id': 56, 'station_type': 1, 'level': 2, 'prefered_order': 15}, {'station_id': 55, 'station_type': 3, 'level': 2, 'prefered_order': 18}, {'station_id': 55, 'station_type': 3, 'level': 1, 'prefered_order': 198}, {'station_id': 55, 'station_type': 1, 'level': 1, 'prefered_order': 135}, {'station_id': 55, 'station_type': 1, 'level': 2, 'prefered_order': 17}, {'station_id': 54, 'station_type': 3, 'level': 2, 'prefered_order': 20}, {'station_id': 54, 'station_type': 3, 'level': 1, 'prefered_order': 136}, {'station_id': 54, 'station_type': 1, 'level': 1, 'prefered_order': 199}, {'station_id': 54, 'station_type': 1, 'level': 2, 'prefered_order': 19}, {'station_id': 53, 'station_type': 3, 'level': 2, 'prefered_order': 22}, {'station_id': 53, 'station_type': 3, 'level': 1, 'prefered_order': 200}, {'station_id': 53, 'station_type': 1, 'level': 1, 'prefered_order': 137}, {'station_id': 53, 'station_type': 1, 'level': 2, 'prefered_order': 21}, {'station_id': 52, 'station_type': 3, 'level': 2, 'prefered_order': 24}, {'station_id': 52, 'station_type': 3, 'level': 1, 'prefered_order': 138}, {'station_id': 52, 'station_type': 1, 'level': 1, 'prefered_order': 201}, {'station_id': 52, 'station_type': 1, 'level': 2, 'prefered_order': 23}, {'station_id': 51, 'station_type': 3, 'level': 2, 'prefered_order': 26}, {'station_id': 51, 'station_type': 3, 'level': 1, 'prefered_order': 202}, {'station_id': 51, 'station_type': 1, 'level': 1, 'prefered_order': 139}, {'station_id': 51, 'station_type': 1, 'level': 2, 'prefered_order': 25}, {'station_id': 50, 'station_type': 3, 'level': 2, 'prefered_order': 28}, {'station_id': 50, 'station_type': 3, 'level': 1, 'prefered_order': 140}, {'station_id': 50, 'station_type': 1, 'level': 1, 'prefered_order': 203}, {'station_id': 50, 'station_type': 1, 'level': 2, 'prefered_order': 27}, {'station_id': 49, 'station_type': 3, 'level': 2, 'prefered_order': 30}, {'station_id': 49, 'station_type': 3, 'level': 1, 'prefered_order': 204}, {'station_id': 49, 'station_type': 1, 'level': 1, 'prefered_order': 141}, {'station_id': 49, 'station_type': 1, 'level': 2, 'prefered_order': 29}, {'station_id': 48, 'station_type': 3, 'level': 2, 'prefered_order': 32}, {'station_id': 48, 'station_type': 3, 'level': 1, 'prefered_order': 142}, {'station_id': 48, 'station_type': 1, 'level': 1, 'prefered_order': 205}, {'station_id': 48, 'station_type': 1, 'level': 2, 'prefered_order': 31}, {'station_id': 47, 'station_type': 3, 'level': 2, 'prefered_order': 34}, {'station_id': 47, 'station_type': 3, 'level': 1, 'prefered_order': 206}, {'station_id': 47, 'station_type': 1, 'level': 1, 'prefered_order': 143}, {'station_id': 47, 'station_type': 1, 'level': 2, 'prefered_order': 33}, {'station_id': 46, 'station_type': 3, 'level': 2, 'prefered_order': 36}, {'station_id': 46, 'station_type': 3, 'level': 1, 'prefered_order': 144}, {'station_id': 46, 'station_type': 1, 'level': 1, 'prefered_order': 207}, {'station_id': 46, 'station_type': 1, 'level': 2, 'prefered_order': 35}, {'station_id': 45, 'station_type': 3, 'level': 2, 'prefered_order': 38}, {'station_id': 45, 'station_type': 3, 'level': 1, 'prefered_order': 208}, {'station_id': 45, 'station_type': 1, 'level': 1, 'prefered_order': 145}, {'station_id': 45, 'station_type': 1, 'level': 2, 'prefered_order': 37}, {'station_id': 44, 'station_type': 3, 'level': 2, 'prefered_order': 40}, {'station_id': 44, 'station_type': 3, 'level': 1, 'prefered_order': 146}, {'station_id': 44, 'station_type': 1, 'level': 1, 'prefered_order': 209}, {'station_id': 44, 'station_type': 1, 'level': 2, 'prefered_order': 39}, {'station_id': 43, 'station_type': 3, 'level': 2, 'prefered_order': 42}, {'station_id': 43, 'station_type': 3, 'level': 1, 'prefered_order': 210}, {'station_id': 43, 'station_type': 1, 'level': 1, 'prefered_order': 147}, {'station_id': 43, 'station_type': 1, 'level': 2, 'prefered_order': 41}, {'station_id': 42, 'station_type': 3, 'level': 2, 'prefered_order': 44}, {'station_id': 42, 'station_type': 3, 'level': 1, 'prefered_order': 148}, {'station_id': 42, 'station_type': 1, 'level': 1, 'prefered_order': 211}, {'station_id': 42, 'station_type': 1, 'level': 2, 'prefered_order': 43}, {'station_id': 41, 'station_type': 3, 'level': 2, 'prefered_order': 46}, {'station_id': 41, 'station_type': 3, 'level': 1, 'prefered_order': 212}, {'station_id': 41, 'station_type': 1, 'level': 1, 'prefered_order': 149}, {'station_id': 41, 'station_type': 1, 'level': 2, 'prefered_order': 45}, {'station_id': 40, 'station_type': 3, 'level': 2, 'prefered_order': 48}, {'station_id': 40, 'station_type': 3, 'level': 1, 'prefered_order': 150}, {'station_id': 40, 'station_type': 1, 'level': 1, 'prefered_order': 213}, {'station_id': 40, 'station_type': 1, 'level': 2, 'prefered_order': 47}, {'station_id': 39, 'station_type': 3, 'level': 2, 'prefered_order': 50}, {'station_id': 39, 'station_type': 3, 'level': 1, 'prefered_order': 214}, {'station_id': 39, 'station_type': 1, 'level': 1, 'prefered_order': 151}, {'station_id': 39, 'station_type': 1, 'level': 2, 'prefered_order': 49}, {'station_id': 38, 'station_type': 3, 'level': 2, 'prefered_order': 52}, {'station_id': 38, 'station_type': 3, 'level': 1, 'prefered_order': 152}, {'station_id': 38, 'station_type': 1, 'level': 1, 'prefered_order': 215}, {'station_id': 38, 'station_type': 1, 'level': 2, 'prefered_order': 51}, {'station_id': 37, 'station_type': 3, 'level': 2, 'prefered_order': 54}, {'station_id': 37, 'station_type': 3, 'level': 1, 'prefered_order': 216}, {'station_id': 37, 'station_type': 1, 'level': 1, 'prefered_order': 153}, {'station_id': 37, 'station_type': 1, 'level': 2, 'prefered_order': 53}, {'station_id': 36, 'station_type': 3, 'level': 2, 'prefered_order': 56}, {'station_id': 36, 'station_type': 3, 'level': 1, 'prefered_order': 154}, {'station_id': 36, 'station_type': 1, 'level': 1, 'prefered_order': 217}, {'station_id': 36, 'station_type': 1, 'level': 2, 'prefered_order': 55}, {'station_id': 35, 'station_type': 3, 'level': 2, 'prefered_order': 58}, {'station_id': 35, 'station_type': 3, 'level': 1, 'prefered_order': 218}, {'station_id': 35, 'station_type': 1, 'level': 1, 'prefered_order': 155}, {'station_id': 35, 'station_type': 1, 'level': 2, 'prefered_order': 57}, {'station_id': 34, 'station_type': 3, 'level': 2, 'prefered_order': 60}, {'station_id': 34, 'station_type': 3, 'level': 1, 'prefered_order': 156}, {'station_id': 34, 'station_type': 1, 'level': 1, 'prefered_order': 219}, {'station_id': 34, 'station_type': 1, 'level': 2, 'prefered_order': 59}, {'station_id': 33, 'station_type': 3, 'level': 2, 'prefered_order': 62}, {'station_id': 33, 'station_type': 3, 'level': 1, 'prefered_order': 220}, {'station_id': 33, 'station_type': 1, 'level': 1, 'prefered_order': 157}, {'station_id': 33, 'station_type': 1, 'level': 2, 'prefered_order': 61}, {'station_id': 32, 'station_type': 3, 'level': 2, 'prefered_order': 64}, {'station_id': 32, 'station_type': 3, 'level': 1, 'prefered_order': 158}, {'station_id': 32, 'station_type': 1, 'level': 1, 'prefered_order': 221}, {'station_id': 32, 'station_type': 1, 'level': 2, 'prefered_order': 63}, {'station_id': 31, 'station_type': 3, 'level': 2, 'prefered_order': 66}, {'station_id': 31, 'station_type': 3, 'level': 1, 'prefered_order': 222}, {'station_id': 31, 'station_type': 1, 'level': 1, 'prefered_order': 159}, {'station_id': 31, 'station_type': 1, 'level': 2, 'prefered_order': 65}, {'station_id': 30, 'station_type': 3, 'level': 2, 'prefered_order': 68}, {'station_id': 30, 'station_type': 3, 'level': 1, 'prefered_order': 160}, {'station_id': 30, 'station_type': 1, 'level': 1, 'prefered_order': 223}, {'station_id': 30, 'station_type': 1, 'level': 2, 'prefered_order': 67}, {'station_id': 29, 'station_type': 3, 'level': 2, 'prefered_order': 70}, {'station_id': 29, 'station_type': 3, 'level': 1, 'prefered_order': 224}, {'station_id': 29, 'station_type': 1, 'level': 1, 'prefered_order': 161}, {'station_id': 29, 'station_type': 1, 'level': 2, 'prefered_order': 69}, {'station_id': 28, 'station_type': 3, 'level': 2, 'prefered_order': 72}, {'station_id': 28, 'station_type': 3, 'level': 1, 'prefered_order': 162}, {'station_id': 28, 'station_type': 1, 'level': 1, 'prefered_order': 225}, {'station_id': 28, 'station_type': 1, 'level': 2, 'prefered_order': 71}, {'station_id': 27, 'station_type': 3, 'level': 2, 'prefered_order': 74}, {'station_id': 27, 'station_type': 3, 'level': 1, 'prefered_order': 226}, {'station_id': 27, 'station_type': 1, 'level': 1, 'prefered_order': 163}, {'station_id': 27, 'station_type': 1, 'level': 2, 'prefered_order': 73}, {'station_id': 26, 'station_type': 3, 'level': 2, 'prefered_order': 76}, {'station_id': 26, 'station_type': 3, 'level': 1, 'prefered_order': 164}, {'station_id': 26, 'station_type': 1, 'level': 1, 'prefered_order': 227}, {'station_id': 26, 'station_type': 1, 'level': 2, 'prefered_order': 75}, {'station_id': 25, 'station_type': 3, 'level': 2, 'prefered_order': 78}, {'station_id': 25, 'station_type': 3, 'level': 1, 'prefered_order': 228}, {'station_id': 25, 'station_type': 1, 'level': 1, 'prefered_order': 165}, {'station_id': 25, 'station_type': 1, 'level': 2, 'prefered_order': 77}, {'station_id': 24, 'station_type': 3, 'level': 2, 'prefered_order': 80}, {'station_id': 24, 'station_type': 3, 'level': 1, 'prefered_order': 166}, {'station_id': 24, 'station_type': 1, 'level': 1, 'prefered_order': 229}, {'station_id': 24, 'station_type': 1, 'level': 2, 'prefered_order': 79}, {'station_id': 23, 'station_type': 3, 'level': 2, 'prefered_order': 82}, {'station_id': 23, 'station_type': 3, 'level': 1, 'prefered_order': 230}, {'station_id': 23, 'station_type': 1, 'level': 1, 'prefered_order': 167}, {'station_id': 23, 'station_type': 1, 'level': 2, 'prefered_order': 81}, {'station_id': 22, 'station_type': 3, 'level': 2, 'prefered_order': 84}, {'station_id': 22, 'station_type': 3, 'level': 1, 'prefered_order': 168}, {'station_id': 22, 'station_type': 1, 'level': 1, 'prefered_order': 231}, {'station_id': 22, 'station_type': 1, 'level': 2, 'prefered_order': 83}, {'station_id': 21, 'station_type': 3, 'level': 2, 'prefered_order': 86}, {'station_id': 21, 'station_type': 3, 'level': 1, 'prefered_order': 232}, {'station_id': 21, 'station_type': 1, 'level': 1, 'prefered_order': 169}, {'station_id': 21, 'station_type': 1, 'level': 2, 'prefered_order': 85}, {'station_id': 20, 'station_type': 3, 'level': 2, 'prefered_order': 88}, {'station_id': 20, 'station_type': 3, 'level': 1, 'prefered_order': 170}, {'station_id': 20, 'station_type': 1, 'level': 1, 'prefered_order': 233}, {'station_id': 20, 'station_type': 1, 'level': 2, 'prefered_order': 87}, {'station_id': 19, 'station_type': 3, 'level': 2, 'prefered_order': 90}, {'station_id': 19, 'station_type': 3, 'level': 1, 'prefered_order': 234}, {'station_id': 19, 'station_type': 1, 'level': 1, 'prefered_order': 171}, {'station_id': 19, 'station_type': 1, 'level': 2, 'prefered_order': 89}, {'station_id': 18, 'station_type': 3, 'level': 2, 'prefered_order': 92}, {'station_id': 18, 'station_type': 3, 'level': 1, 'prefered_order': 172}, {'station_id': 18, 'station_type': 1, 'level': 1, 'prefered_order': 235}, {'station_id': 18, 'station_type': 1, 'level': 2, 'prefered_order': 91}, {'station_id': 17, 'station_type': 3, 'level': 2, 'prefered_order': 94}, {'station_id': 17, 'station_type': 3, 'level': 1, 'prefered_order': 236}, {'station_id': 17, 'station_type': 1, 'level': 1, 'prefered_order': 173}, {'station_id': 17, 'station_type': 1, 'level': 2, 'prefered_order': 93}, {'station_id': 16, 'station_type': 3, 'level': 2, 'prefered_order': 96}, {'station_id': 16, 'station_type': 3, 'level': 1, 'prefered_order': 174}, {'station_id': 16, 'station_type': 1, 'level': 1, 'prefered_order': 237}, {'station_id': 16, 'station_type': 1, 'level': 2, 'prefered_order': 95}, {'station_id': 15, 'station_type': 3, 'level': 2, 'prefered_order': 98}, {'station_id': 15, 'station_type': 3, 'level': 1, 'prefered_order': 238}, {'station_id': 15, 'station_type': 1, 'level': 1, 'prefered_order': 175}, {'station_id': 15, 'station_type': 1, 'level': 2, 'prefered_order': 97}, {'station_id': 14, 'station_type': 3, 'level': 2, 'prefered_order': 100}, {'station_id': 14, 'station_type': 3, 'level': 1, 'prefered_order': 176}, {'station_id': 14, 'station_type': 1, 'level': 1, 'prefered_order': 239}, {'station_id': 14, 'station_type': 1, 'level': 2, 'prefered_order': 99}, {'station_id': 13, 'station_type': 3, 'level': 2, 'prefered_order': 102}, {'station_id': 13, 'station_type': 3, 'level': 1, 'prefered_order': 240}, {'station_id': 13, 'station_type': 1, 'level': 1, 'prefered_order': 177}, {'station_id': 13, 'station_type': 1, 'level': 2, 'prefered_order': 101}, {'station_id': 12, 'station_type': 3, 'level': 2, 'prefered_order': 104}, {'station_id': 12, 'station_type': 3, 'level': 1, 'prefered_order': 178}, {'station_id': 12, 'station_type': 1, 'level': 1, 'prefered_order': 241}, {'station_id': 12, 'station_type': 1, 'level': 2, 'prefered_order': 103}, {'station_id': 11, 'station_type': 3, 'level': 2, 'prefered_order': 106}, {'station_id': 11, 'station_type': 3, 'level': 1, 'prefered_order': 242}, {'station_id': 11, 'station_type': 1, 'level': 1, 'prefered_order': 179}, {'station_id': 11, 'station_type': 1, 'level': 2, 'prefered_order': 105}, {'station_id': 10, 'station_type': 3, 'level': 2, 'prefered_order': 108}, {'station_id': 10, 'station_type': 3, 'level': 1, 'prefered_order': 180}, {'station_id': 10, 'station_type': 1, 'level': 1, 'prefered_order': 243}, {'station_id': 10, 'station_type': 1, 'level': 2, 'prefered_order': 107}, {'station_id': 9, 'station_type': 3, 'level': 2, 'prefered_order': 110}, {'station_id': 9, 'station_type': 3, 'level': 1, 'prefered_order': 244}, {'station_id': 9, 'station_type': 1, 'level': 1, 'prefered_order': 181}, {'station_id': 9, 'station_type': 1, 'level': 2, 'prefered_order': 109}, {'station_id': 8, 'station_type': 3, 'level': 2, 'prefered_order': 112}, {'station_id': 8, 'station_type': 3, 'level': 1, 'prefered_order': 182}, {'station_id': 8, 'station_type': 1, 'level': 1, 'prefered_order': 245}, {'station_id': 8, 'station_type': 1, 'level': 2, 'prefered_order': 111}, {'station_id': 7, 'station_type': 3, 'level': 2, 'prefered_order': 114}, {'station_id': 7, 'station_type': 3, 'level': 1, 'prefered_order': 246}, {'station_id': 7, 'station_type': 1, 'level': 1, 'prefered_order': 183}, {'station_id': 7, 'station_type': 1, 'level': 2, 'prefered_order': 113}, {'station_id': 6, 'station_type': 3, 'level': 2, 'prefered_order': 116}, {'station_id': 6, 'station_type': 3, 'level': 1, 'prefered_order': 184}, {'station_id': 6, 'station_type': 1, 'level': 1, 'prefered_order': 247}, {'station_id': 6, 'station_type': 1, 'level': 2, 'prefered_order': 115}, {'station_id': 5, 'station_type': 3, 'level': 2, 'prefered_order': 118}, {'station_id': 5, 'station_type': 3, 'level': 1, 'prefered_order': 248}, {'station_id': 5, 'station_type': 1, 'level': 1, 'prefered_order': 185}, {'station_id': 5, 'station_type': 1, 'level': 2, 'prefered_order': 117}, {'station_id': 4, 'station_type': 3, 'level': 2, 'prefered_order': 120}, {'station_id': 4, 'station_type': 3, 'level': 1, 'prefered_order': 186}, {'station_id': 4, 'station_type': 1, 'level': 1, 'prefered_order': 249}, {'station_id': 4, 'station_type': 1, 'level': 2, 'prefered_order': 119}, {'station_id': 3, 'station_type': 3, 'level': 2, 'prefered_order': 122}, {'station_id': 3, 'station_type': 3, 'level': 1, 'prefered_order': 250}, {'station_id': 3, 'station_type': 1, 'level': 1, 'prefered_order': 187}, {'station_id': 3, 'station_type': 1, 'level': 2, 'prefered_order': 121}, {'station_id': 2, 'station_type': 3, 'level': 2, 'prefered_order': 124}, {'station_id': 2, 'station_type': 3, 'level': 1, 'prefered_order': 188}, {'station_id': 2, 'station_type': 1, 'level': 1, 'prefered_order': 251}, {'station_id': 2, 'station_type': 1, 'level': 2, 'prefered_order': 123}, {'station_id': 1, 'station_type': 3, 'level': 2, 'prefered_order': 126}, {'station_id': 1, 'station_type': 3, 'level': 1, 'prefered_order': 252}, {'station_id': 1, 'station_type': 1, 'level': 1, 'prefered_order': 189}, {'station_id': 1, 'station_type': 1, 'level': 2, 'prefered_order': 125}]



update_storage_collection(data_to_update)